{% extends "base.html.twig" %}

{% block title %}Administration{% endblock %}
{% block stylesheets %}

    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('css/admin.css') }}">

{% endblock %}

{% block body %}

    <div class="container-fluid heading-page">
        <h1 class="text-center">ADMINISTRATION</h1>
        <p class="text-center">Accueil >> Administration</p>
    </div>
    <div class="wave-svg">
        <svg width="100%" height="100%" viewBox="0 0 1430 80" version="1.1" xmlns="http://www.w3.org/2000/svg"
             xmlns:xlink="http://www.w3.org/1999/xlink">
            <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                <g id="wave-driedwood">
                    <g transform="translate(720.000000, 40.000000) scale(1, -1) translate(-720.000000, -40.000000) ">
                        <g>
                            <path d="M0,52 C0,52 153,1.46804748e-14 378.5,0 C604,0 836,52 1005,52 C1174,52 1440,0 1440,0 L1440,80 L0,80 L0,52 Z"
                                  fill="#E7E1DC"></path>
                            <path d="M0,78 C0,78 153,26 378.5,26 C604,26 836,78 1005,78 C1174,78 1440,26 1440,26 L1440,80 L0,80 L0,78 Z"
                                  fill="#F7F3F1"></path>
                        </g>
                    </g>
                </g>
            </g>
        </svg>
    </div>

    <section class="mt-5">
        <div class="container-fluid">
            <div class="heading">
                <span>{{ 'Gérez depuis ce pannel les utilisateurs ainsi que les actualité'|upper }}</span>
            </div>
        </div>

        <div class="row justify-content-center">
            {#-------------------------------#}
            {#PARTIE Gestion des utilisateurs#}
            {#-------------------------------#}
            <div class="col m-3" style="border: 1px solid grey">
                <h3>Gestion des utilisateurs</h3>
                <input type="search" id="searchUser" placeholder="Rechercher un utilisateur" class="input-group">
                <section id="userSection">

                    <div class="container">

                        <div class="flex-wrap flex-column users-display flex-nowrap p-0">
                            {% for user in users %}
                                <div class="row mb-2">
                                    <div class="col-3 col-sm-4 col-lg-2 ml-2">
                                        <img src="{{ asset('img/'~user.profilePicture) }}" alt=""
                                             class="imgUser rounded-circle">
                                    </div>
                                    <div class="col-3 col-sm-4 col-lg-2 mr-3">
                                        <p class=""><strong>{{ user.username|capitalize }}</strong></p>
                                        <span>
                                                    {% for role in user.roles %}
                                                        {% if role == 'ROLE_ADMIN' %}
                                                            <p>{{ 'administrateur' | upper }}</p>
                                                        {% elseif role == 'ROLE_NATURALISTE' %}
                                                            <p>{{ 'Naturaliste' | upper }}</p>
                                                        {% elseif role == 'ROLE_USER' %}
                                                            <p>{{ 'Utilisateur' | upper }}</p>
                                                        {% else %}
                                                            <p>{{ "Cette personne n'a pas de rôle, comment est-ce possible?" | upper }}</p>
                                                        {% endif %}
                                                    {% endfor %}
                                                </span>
                                    </div>

                                    <div class="media-body col-6 col-sm-8 col-lg-6 ml-3">
                                        <p class="text-justify">{{ user.email|capitalize }}</p>
                                        <div>
                                            <a href="#">
                                                <i class="fa fa-star-half-o fa-2x"
                                                   aria-hidden="true"
                                                   id="becomeUser"
                                                   data-userId="{{ user.id }}"
                                                   {% for role in user.roles %}
                                                       {% if role == "ROLE_NATURALISTE" %}
                                                           style="opacity: 0.5"
                                                       {% endif %}
                                                   {% endfor %} >
                                                </i>
                                            </a>
                                            <a href="#">
                                                <i class="fa fa-star fa-2x"
                                                   aria-hidden="true"
                                                   id="becomeNaturaliste"
                                                   {% for role in user.roles %}
                                                    {% if role == "ROLE_USER" %}
                                                        style="opacity: 0.5"
                                                    {% endif %}
                                                        {% endfor %} >

                                                </i>
                                            </a>
                                            <a href="#"><i class="fa fa-trash fa-2x" data-toggle="modal" data-target="#deleteUserModal" aria-hidden="true"></i></a>

                                            {#-----MODAL DELETE USER-----#}
                                            <div class="modal" id="deleteUserModal">
                                                <div class="modal-dialog">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <div class="modal-title">
                                                                <h5>Je suis un titre</h5>
                                                                <button class="close" data-dismiss="modal">&times;</button>
                                                            </div>
                                                            <div class="modal-body">
                                                                <p>Vous êtes sur le point de supprimer définitivement {{ user.username }}</p>
                                                            </div>
                                                            <div class="modal-footer row">
                                                                <button class="btn btn-info col-3 close" style="background-color: grey" data-dismiss="modal">Annuler</button>
                                                                <button class="btn col-3 ml-auto" type="submit" data-dismiss="modal" id="confirmDeleteUserBtn" data-userid="{{ user.id }}" >Confirmer</button>

                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            {#-----END MODAL DELETE USER-----#}

                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>

                    </div>
                </section>

            </div>
            {#-------------------------------#}
            {#PARTIE Gestion des actualités#}
            {#-------------------------------#}
            <div class="col m-3" style="border: 1px solid grey">
                <h3>Gestion des actualités</h3>
            </div>
        </div>

    </section>

{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('js/admin.js') }}"></script>
{% endblock %}

